<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>構件管理</title>
    <link rel="stylesheet" href="styles.css">

    <style>
        body { padding: 20px; }

        .header-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            align-items: center;
        }
        .header-title {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
        }
        .back-btn {
            padding: 10px 20px;
            background: #2f3340;
            color: #fff;
            border-radius: 12px;
            cursor: pointer;
        }

        .input-box {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            background: #2a2b31;
            border: none;
            color: #fff;
            margin-bottom: 14px;
        }

        .primary-btn {
            width: 100%;
            padding: 14px;
            background: #3d7bff;
            border-radius: 14px;
            color: #fff;
            text-align: center;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .section-title {
            color: #bbb;
            margin: 16px 0 8px 0;
            font-size: 15px;
        }

        .item-card {
            background: #2a2b31;
            color: #fff;
            padding: 16px;
            border-radius: 14px;
            margin-bottom: 16px;
        }

        .item-head {
            font-size: 18px;
            font-weight: bold;
        }
        .item-sub {
            margin-top: 4px;
            color: #bbb;
            font-size: 14px;
        }

        .row {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .select-box {
            flex: 1;
            padding: 14px;
            border-radius: 12px;
            background: #33353d;
            border: none;
            color: #fff;
        }

        .btn-update {
            padding: 12px 18px;
            background: #3d7bff;
            color: #fff;
            border-radius: 12px;
            cursor: pointer;
        }

        .btn-delete {
            padding: 12px 18px;
            background: #d9534f;
            color: #fff;
            border-radius: 12px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <!-- Header -->
    <div class="header-row">
        <div class="header-title">構件管理</div>
        <div class="back-btn" onclick="location.href='index.html'">返回主畫面</div>
    </div>

    <!-- Search -->
    <input id="search" class="input-box" placeholder="搜尋：編號 / 規格 / 材質 / 位置 / 重量 / 數量" oninput="renderList()">

    <!-- 新增構件 -->
    <div class="section-title">單筆新增構件</div>

    <input id="newId" class="input-box" placeholder="構件編號，例如 A-001">
    <input id="newPos" class="input-box" placeholder="構件位置，例如 0/A">
    <input id="newWeight" class="input-box" placeholder="構件重量（可含千分位）">
    <input id="newQty" class="input-box" placeholder="構件數量，例如 10">
    <input id="newSpec" class="input-box" placeholder="構件規格，例如 PL-25*500*650">

    <div class="primary-btn" onclick="addItem()">新增一筆</div>

    <div class="section-title">構件狀態管理（點選展開）</div>

    <div id="itemList"></div>

    <script>
        let items = [];

        function addItem() {
            const id = newId.value.trim();
            const pos = newPos.value.trim();
            const w = newWeight.value.trim();
            const q = newQty.value.trim();
            const s = newSpec.value.trim();

            if (!id || !q) {
                alert("至少需要填寫【構件編號】與【數量】");
                return;
            }

            items.push({
                id,
                pos,
                weight: w,
                qty: q,
                spec: s,
                status: "未進料"
            });

            newId.value = "";
            newPos.value = "";
            newWeight.value = "";
            newQty.value = "";
            newSpec.value = "";

            renderList();
        }

        function renderList() {
            const list = document.getElementById("itemList");
            list.innerHTML = "";

            const keyword = search.value.trim().toLowerCase();

            items
                .filter(a => JSON.stringify(a).toLowerCase().includes(keyword))
                .forEach((item, index) => {
                const card = document.createElement("div");
                card.className = "item-card";

                card.innerHTML = `
                    <div class="item-head">${item.id}</div>
                    <div class="item-sub">${item.spec || "-"}　|　位置：${item.pos || "-"}　|　重量：${item.weight || "-"}　|　數量：${item.qty}</div>

                    <div class="row">
                        <select class="select-box" onchange="updateStatus(${index}, this.value)">
                            <option ${item.status === "未進料" ? "selected" : ""}>未進料</option>
                            <option ${item.status === "預定中" ? "selected" : ""}>預定中</option>
                            <option ${item.status === "已進料" ? "selected" : ""}>已進料</option>
                            <option ${item.status === "已使用" ? "selected" : ""}>已使用</option>
                        </select>

                        <div class="btn-update" onclick="saveItem(${index})">更新</div>
                        <div class="btn-delete" onclick="deleteItem(${index})">刪除</div>
                    </div>
                `;

                list.appendChild(card);
            });
        }

        function updateStatus(i, status) {
            items[i].status = status;
        }

        function saveItem(i) {
            alert("已更新構件狀態。");
        }

        function deleteItem(i) {
            if (!confirm("確定刪除此構件？")) return;
            items.splice(i, 1);
            renderList();
        }

        renderList();
    </script>

</body>
</html>
